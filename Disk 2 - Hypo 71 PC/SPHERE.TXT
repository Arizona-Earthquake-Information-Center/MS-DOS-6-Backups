SPHERE.TXT                                  Potsdam, 1991, January

Wolfgang K”hler, CIPE, Tel. 310-234
  Potsdam 1580,
  Telegrafenberg,
  FRG


Information about the programs for seismic fault plane solutions
----------------------------------------------------------------

0. General Informations
-----------------------
The 5,25" disk is formatted for IBM compatible computers with
a capacity of 360 kbyte.
It containes the following files :

  - SPHERE.PAS : program for numerical search for optimal fault
                 plane solutions of a given set of events, input
                 and output are disk files
  - WULFF.PAS  : program for graphic display of computed
                 solutions in the wulff net
  - SPHERE.EXE,
    WULFF.EXE  : compiled programs  (executable)

  - INC1.PAS   : an include file for some general procedures

  - GRAPHEXT.PAS : some procedures for graphics display

  - XXXXn.DAT : example input files for "SPHERE"

  - XXXXn.ERG : corresponding result files , generated by "SPHERE"

  - XXXX.FPS  : second result file (fault plane parameters),
                generated by "SPHERE"
  - GRAPH.TPU, EGAVGA.BGI,
    LITT.CHR  : files for graphic output from "WULFF.PAS"

All programs are written in "Turbo-Pascal 4.0" (or higher
verions), but you may run the .EXE files on IBM compatibles
without the Turbo-Pascal compiler.

Graphic output requires an VGA display on your computer and
the graph-driver "EGAVGA.BGI" must be present in the current
directory.

A numeric coprocessor is not necessary but it will speed up
the computation considerably. If you want to take advantage
from a coprocessor you have to set the compiler switch
"Emulation = off".

1. Program "SPHERE"
-------------------
This program computes of the optimum focal plane solutions
from polarity readings of first motion for a given set of
stations , for one or more seismic events.

1.1 Input data for SPHERE
-------------------------
A set of n ASCII-files (n = 0..9) with extension ".DAT" :
"XXXXn.DAT".
These files have to be created with a text editor , e.g.
with the Turbo-Pascal editor.
(If you use "Wordstar" be sure that no control codes are
in the text.)

It contains the following records:

1. one description record, only used for the printout
   (e.g. "Event of 13.5.1999, computed with model M3")

2. one record for each station, containing:

   a) station code, 4 characters (eventually blanks)

   b) azimuth of the ray from the source to the station
      (in grd = [0..360ø] )

   c) take-off-angle of this ray (this angle has to be
      computed before by an ray tracing program, which
      computes it as a function of distance between source
      and station for a given crustal model).
      The  take-off-angle is measured to the downward
      vertical axis (in the lower  focal hemisphere).

   d) The polarity of the first motion, a real number
      between [-1.0 ... 1.0].
      The sign describes the polarity , the absolute value
      is the weighting factor, describing the clearness of
      the onset. Indubitable readings shall get the values
      +1.0 or -1.0.

   (e.g. " MOX  273.5  55.4  -0.5" )

1.2 Computational Algorithm
---------------------------
The program internally uses a projection of the focal sphere
to  the complex plane for which great circles become straight
lines.
This is not a stereographic projection, but the results are
given in normal spheric coordinates.

The algorithm works in 2 steps:

*  first : A "brutal force" step. For all significant different
   focal plane solutions the number of stations is computed
   which are lying in the "false" quadrant (d.e. that do not
   fit the solution).
   The 50 solutions with minimum false numbers (with respect
   to the weighting factors) are stored for the second step.

*  second : also the theoretical radiation pattern for the
   focal plane solution is taken into account.  That means
   each station in a false quadrant gets a second weighting
   factor of the value :

     F = sin(2*theta) * cos(phi),

   where "theta" and "phi" are the distance angles to the
   fault plane and the equatorial plane, respectively.

   The function to be minimized is then given by the variance :

          \~~                               2
     V =   >  (q * sin(2*theta) * cos(phi))   .
          /     i
          ~~~
           i
    The sum (i) is to build over all non-fitting stations.
    Thus false stations near the nodal planes become less
    significant.

For all solutions computed in the first step this variance
is computed and they are sorted with respect to this value.

1.3 Output data
---------------
The program generates an output file "XXXXn.ERG" for each
input file "XXXXn.DAT" in the current directory.
This is an ASCII-text file, in which each line corresponds
to one solution described above.
The first solution in this file is that one with minimum
variance, the optimum solution.

The record for each solution contains the following values :
 1. the variance
 2. the  number of "false" stations
 3. the coordinates  of the poles of the two nodal planes in
    polar-coordinates (like the input data : first azimuth,
    then angle to the z-axis (vertical), all in degrees.)

Further a second text file, that consists the optimum fault
plane parameters for all n events under investigation, is
generated.
It has the name "XXXX.FPS" and the following structure.

For each event n four records are written :

1. record : description comment
           ( = first record of XXXXn.dat file)

2. record : nodal plane parameters ( azimuth & dip for both
            nodal planes) and the variance, an equivalent sum
            over fitting stations, number of stations and
            number of nonfitting stations

3. record : fault plane parameters for both possible fault
            planes:  strike, dip and rake and a description
            ( "normal" or "thrust" fault )

4. record : main stress axes, pressure and tension, given as
            azimuth and dip


2. Program "WULFF"
------------------
Graphic  display of the computed focal plane solutions of the
program SPHERE and computation of corresponding parameters :
- Main stress axes ( P- and T- axis with azimuth and dip)
- Fault plane parameters ( strike, dip and rake )

2.1 Input data
--------------
This program needs the input data file "XXXXn.dat" and the
file "XXXXn.ERG" created by the program SPHERE.

2.2 Algorithm
-------------
The graphic display uses the Wulff net as a stereographic
projection. It needs an VGA-adapter card.
You may step through all 40 computed solutions by typing
the requested solution number.

2.3 Graphic output
------------------
The Wulff-net with all the stations, the nodal planes, the
equatorial plane, directions of the main stress axis
(squares) are shown on the graphic display.
If wanted, also the station code can be drawn near the points.

The text output contains the parameters of the main stress
axes and the commonly used fault plane parameters (strike,
dip and rake) for both nodal planes considered as fault planes.


